
import matplotlib.pyplot as plt
import numpy as np
import statistics as stats

# Some example data to display
x = np.linspace(0, 2 * np.pi, 400)
y = np.sin(x ** 2)

#fig, axs = plt.subplots(6)
#fig.suptitle('Vertically stacked subplots')
#axs[0].plot(x, y)
#axs[1].plot(x, -y)
#axs[2].plot(x, -y)
#axs[3].plot(x, -y)
#axs[4].plot(x, -y)
#axs[5].plot(x, -y)

x_Distance_80=[35940.0, 36020.0, 36100.0, 36180.0, 36260.0, 36340.0, 36420.0, 36500.0, 36580.0, 36660.0, 36740.0, 36820.0, 36900.0, 36980.0, 37060.0, 37140.0, 37220.0, 37300.0, 37380.0, 37460.0, 37540.0, 37620.0, 37700.0, 37780.0, 37860.0]
y_Distance_80=[14.285712417576892, 14.404069323238891, 14.383237128047707, 14.511398941795752, 14.413276344097728, 14.365816460337523, 14.45409716589179, 14.845194944490608, 14.61253246527057, 19.79192067189215, 110.47619871934944, 193.61905547784198, 27.587016713808488, 18.630335773558997, 15.5532116930648, 15.747479342347045, 15.366042360524393, 15.199541151607857, 15.282899030322039, 16.708122785256695, 14.756610661774555, 14.520146253853202, 14.347581828015581, 14.439281702703967, 14.405770497077253]
v_Distance_80=36820.0
x_Tip_80=[40.0, 120.0, 200.0, 280.0, 360.0, 440.0, 520.0, 600.0, 680.0, 760.0, 840.0, 920.0, 1000.0, 1080.0, 1160.0, 1240.0, 1320.0, 1400.0, 1480.0, 1560.0, 1640.0, 1720.0, 1800.0, 1880.0, 1960.0]
y_Tip_80=[19.320906852459572, 18.905335588518437, 18.679499354414197, 19.342271889060868, 27.080436513014085, 36.807267854604554, 44.310008363953344, 65.41771607869602, 98.05400015715546, 245.45470948773578, 346.9504641850869, 371.42658896735986, 339.8367716305579, 246.86621226122026, 223.28050893080544, 178.16344014468888, 114.76982911850331, 75.71262200351774, 36.402524809740015, 32.60182738748518, 22.26895099685895, 20.435783721006942, 20.435783721006942, 20.435783721006942, 20.435783721006942]
v_Tip_80=920.0
x_Tilt_80=[40.0, 120.0, 200.0, 280.0, 360.0, 440.0, 520.0, 600.0, 680.0, 760.0, 840.0, 920.0, 1000.0, 1080.0, 1160.0, 1240.0, 1320.0, 1400.0, 1480.0, 1560.0, 1640.0, 1720.0, 1800.0, 1880.0, 1960.0]
y_Tilt_80=[14.95800087075379, 14.899039080835825, 14.870037039756463, 14.965079066656244, 14.98420735720304, 15.24137013845371, 14.852459563797478, 15.018232140619318, 14.91822970517227, 14.963313268541828, 14.839226784482408, 14.992754969192546, 14.879305445253909, 14.95809458060177, 15.067918972132205, 15.343315542090327, 15.109821871739943, 15.1271315485493, 15.591572311385406, 15.103451529835148, 15.595094126193228, 15.321680148640823, 15.321680148640823, 15.321680148640823, 15.321680148640823]
v_Tilt_80=1640.0

x_Distance_801=[38537.0, 38617.0, 38697.0, 38777.0, 38857.0, 38937.0, 39017.0, 39097.0, 39177.0, 39257.0, 39337.0]
y_Distance_801=[14.757540653112784, 15.033954060361932, 26.905019835837855, 246.6580409114325, 86.37439595248566, 18.48351620441688, 17.874473780326056, 15.952967397584583, 15.196157316417128, 15.548542739126798, 14.702784833954528]
v_Distance_801=38777.0
x_Tip_801=[520.0, 600.0, 680.0, 760.0, 840.0, 920.0, 1000.0, 1080.0, 1160.0, 1240.0, 1320.0]
y_Tip_801=[16.891935724405894, 18.5465607577385, 18.390505847062435, 19.632550653166234, 28.45866164181951, 37.52257655554028, 50.31081315394239, 69.4768489975971, 116.3377774220833, 244.77862297169474, 364.2738040010053]
v_Tip_801=1320.0
x_Tilt_801=[1240.0, 1320.0, 1400.0, 1480.0, 1560.0, 1640.0, 1720.0, 1800.0, 1880.0, 1960.0, 2040.0]
y_Tilt_801=[164.5728513677745, 15.986705841797573, 16.04326312765097, 15.541137958049232, 15.463685011915242, 15.306559144610393, 14.96796010283364, 14.96796010283364, 14.96796010283364, 14.96796010283364, 14.96796010283364]
v_Tilt_801=1240.0

x_Distance_30=[38187.0, 38217.0, 38247.0, 38277.0, 38307.0, 38337.0, 38367.0, 38397.0, 38427.0, 38457.0, 38487.0, 38517.0, 38547.0, 38577.0, 38607.0, 38637.0, 38667.0, 38697.0, 38727.0, 38757.0, 38787.0]
y_Distance_30=[14.536048383656603, 14.514626580940044, 14.467825075878746, 14.5983407406908, 14.635350250596414, 14.817137694806027, 14.870431252051397, 14.760338014838418, 14.728437431176724, 15.008490918789974, 16.78982872319372, 21.68783587026237, 34.549564115280916, 74.21591488466618, 199.69433798776032, 371.25405311641373, 205.5276904307933, 74.6984061403121, 43.499495839841614, 23.12576857651711, 17.346122616232854]
v_Distance_30=38637.0
x_Tip_30=[1020.0, 1050.0, 1080.0, 1110.0, 1140.0, 1170.0, 1200.0, 1230.0, 1260.0, 1290.0, 1320.0, 1350.0, 1380.0, 1410.0, 1440.0, 1470.0, 1500.0, 1530.0, 1560.0, 1590.0, 1620.0]
y_Tip_30=[17.26480793378014, 19.311566714837774, 19.186830464379234, 18.831959304876758, 18.663449619519625, 17.692624980239465, 17.49275778308736, 18.66572497005412, 19.776839895485814, 22.047299063896446, 24.48396865581239, 26.099206716697747, 32.17595662967665, 36.275845147974636, 40.5624760892736, 43.013671211007406, 44.81304402609021, 52.44495490030964, 52.61200936086578, 63.70517275253, 96.56984971561451]
v_Tip_30=1620.0
x_Tilt_30=[940.0, 970.0, 1000.0, 1030.0, 1060.0, 1090.0, 1120.0, 1150.0, 1180.0, 1210.0, 1240.0, 1270.0, 1300.0, 1330.0, 1360.0, 1390.0, 1420.0, 1450.0, 1480.0, 1510.0, 1540.0]
y_Tilt_30=[272.52891340722795, 14.990379857545115, 15.072510858593724, 15.03479042337931, 15.100445529378243, 15.078839134799995, 15.120794594720964, 15.011469215676385, 15.056890085258061, 15.05134707852227, 15.016106428426514, 15.032544873933713, 15.005670412200278, 15.043735821025756, 14.95642425230549, 14.947061081308862, 14.954595966348194, 14.926892680663018, 15.033828224032895, 15.075157685721425, 15.054076386878751]
v_Tilt_30=940.0

x_Distance_301=[38263.0, 38293.0, 38323.0, 38353.0, 38383.0, 38413.0, 38443.0, 38473.0, 38503.0, 38533.0, 38563.0]
y_Distance_301=[14.759626541067252, 14.655552102496893, 14.967863071205738, 16.010985545440377, 19.67572131596204, 30.100318748524067, 66.74694376900312, 155.47667302669507, 338.1959383297225, 299.2027690351549, 105.05086090457482]
v_Distance_301=38503.0
x_Tip_301=[1470.0, 1500.0, 1530.0, 1560.0, 1590.0, 1620.0, 1650.0, 1680.0, 1710.0, 1740.0, 1770.0]
y_Tip_301=[18.794973191327855, 20.820362048951715, 28.442891539534706, 32.05283201599216, 35.29508712796289, 37.807127983113375, 38.30419854052231, 43.064809113862985, 48.327951189587566, 59.76941110333885, 59.76941110333885]
v_Tip_301=1740.0
x_Tilt_301=[790.0, 820.0, 850.0, 880.0, 910.0, 940.0, 970.0, 1000.0, 1030.0, 1060.0, 1090.0]
y_Tilt_301=[30.186590478884952, 14.990194820611336, 14.99574876079754, 14.925252096115397, 14.967594040094681, 15.044364768467078, 14.979299111569818, 14.98002164279262, 14.95110443549155, 15.020642820804746, 14.913789040011252]
v_Tilt_301=790.0


#x_Distance_80=[6039.7, 6119.7, 6199.7, 6279.7, 6359.7, 6439.7, 6519.7, 6599.7, 6679.7, 6759.7, 6839.7, 6919.7, 6999.7, 7079.7, 7159.7, 7239.700000000001, 7319.700000000001, 7399.700000000001, 7479.700000000001, 7559.700000000001, 7639.700000000001, 7719.700000000001, 7799.700000000001, 7879.700000000001, 7959.700000000001]
#y_Distance_80=[12.110954534666256, 12.154340152875086, 12.16253209744746, 12.205598814043718, 12.147693323732101, 12.152358134178186, 12.162694318457351, 12.208604346141385, 12.229134070063711, 12.298504570212273, 12.369999458217219, 12.546330931232077, 12.653263009016847, 13.417575260107569, 34.58369558961964, 1325.1043447953018, 72.25726928126383, 16.18145162710691, 13.923802850018914, 13.24007707787498, 12.953537157879051, 12.450035300701678, 12.348219033481062, 12.33826062583676, 12.282603175691847]
#v_Distance_80=7239.700000000001
#x_Tip_80=[40.0, 120.0, 200.0, 280.0, 360.0, 440.0, 520.0, 600.0, 680.0, 760.0, 840.0, 920.0, 1000.0, 1080.0, 1160.0, 1240.0, 1320.0, 1400.0, 1480.0, 1560.0, 1640.0, 1720.0, 1800.0, 1880.0, 1960.0]
#y_Tip_80=[11.731352588723343, 11.839838669461885, 11.958806824766562, 12.07741402984509, 12.496746973491781, 13.378011910628533, 26.483394698298582, 361.0848004892103, 495.1811324492423, 34.49113255888581, 15.238600453193051, 13.70132864404139, 13.012481204003475, 12.702448489924393, 12.244213106375145, 11.994684322457132, 11.94336915050484, 12.06185313518213, 11.958169748342389, 11.894808265065773, 11.774178604893716, 11.662171006051768, 11.662171006051768, 11.662171006051768, 11.662171006051768]
#v_Tip_80=680.0
#x_Tilt_80=[40.0, 120.0, 200.0, 280.0, 360.0, 440.0, 520.0, 600.0, 680.0, 760.0, 840.0, 920.0, 1000.0, 1080.0, 1160.0, 1240.0, 1320.0, 1400.0, 1480.0, 1560.0, 1640.0, 1720.0, 1800.0, 1880.0, 1960.0]
#y_Tilt_80=[12.809442530935971, 13.056435977310823, 13.052141208979982, 13.896806252904263, 14.750502656719284, 60.43100383614137, 54.477936665043245, 14.800827632354412, 13.704453971944899, 13.173949205664545, 12.907564194928707, 12.889623705618597, 12.812800295404584, 12.740538197104177, 12.689882578661829, 12.718120818371565, 12.716908475172485, 12.60235082687575, 12.54083129957851, 12.486522684299985, 12.454800179813262, 12.454578431396552, 12.454578431396552, 12.454578431396552, 12.454578431396552]
#v_Tilt_80=440.0

#x_Distance_801=[6839.700000000001, 6919.700000000001, 6999.700000000001, 7079.700000000001, 7159.700000000001, 7239.700000000001, 7319.700000000001, 7399.700000000001, 7479.700000000001, 7559.700000000001, 7639.700000000001]
#y_Distance_801=[12.64587400722549, 12.670788733513024, 12.824937663875385, 12.873306661932201, 13.067101637306806, 13.840055200065883, 17.66660814746332, 191.92701668877922, 658.4861473192367, 30.05264767780861, 15.866928190880621]
#v_Distance_801=7479.700000000001
#x_Tip_801=[280.0, 360.0, 440.0, 520.0, 600.0, 680.0, 760.0, 840.0, 920.0, 1000.0, 1080.0]
#y_Tip_801=[12.18077852542398, 12.336973224988398, 12.962816180975384, 13.503553223661399, 34.531996834093576, 811.0635997629668, 312.0265347847042, 31.03204948611979, 15.394624506928611, 13.428255857059943, 13.06885283661804]
#v_Tip_801=680.0
#x_Tilt_801=[40.0, 120.0, 200.0, 280.0, 360.0, 440.0, 520.0, 600.0, 680.0, 760.0, 840.0]
#y_Tilt_801=[12.86163028569565, 12.871581902663028, 12.949565099517933, 12.981397409209961, 13.431507720803541, 14.057052902040223, 17.497794918796213, 1736.914549878174, 18.716470877070954, 14.195835937052284, 13.182039830536077]
#v_Tilt_801=600.0

#x_Distance_30=[7179.700000000001, 7209.700000000001, 7239.700000000001, 7269.700000000001, 7299.700000000001, 7329.700000000001, 7359.700000000001, 7389.700000000001, 7419.700000000001, 7449.700000000001, 7479.700000000001, 7509.700000000001, 7539.700000000001, 7569.700000000001, 7599.700000000001, 7629.700000000001, 7659.700000000001, 7689.700000000001, 7719.700000000001, 7749.700000000001, 7779.700000000001]
#y_Distance_30=[13.248310589492672, 13.109604602117681, 13.31565519422609, 13.669600611711463, 13.894591131778068, 14.273979366579432, 14.288783305893269, 16.349204572880417, 28.516549173843394, 46.31250811681886, 175.20846159105196, 1125.9452373862841, 1501.5905909377752, 379.47184097949565, 66.11101337631587, 36.50915573729047, 18.171892671062004, 16.29200457093581, 15.58367779270951, 14.473971201063716, 13.318852110298808]
#v_Distance_30=7539.700000000001
#x_Tip_30=[380.0, 410.0, 440.0, 470.0, 500.0, 530.0, 560.0, 590.0, 620.0, 650.0, 680.0, 710.0, 740.0, 770.0, 800.0, 830.0, 860.0, 890.0, 920.0, 950.0, 980.0]
#y_Tip_30=[12.463411457966714, 12.64475491748194, 13.0034579785474, 13.141230644078334, 13.509932335202146, 13.938389525508267, 18.112773243085726, 28.167016825912476, 48.43866763059686, 140.02777766458593, 638.8357167227432, 1245.3887568584673, 906.9968166599874, 217.1816543825036, 61.415678878132, 33.827192670241956, 19.506612422727997, 15.900481620876523, 15.409902130801157, 14.936966301792989, 14.450266184974922]
#v_Tip_30=710.0
#x_Tilt_30=[300.0, 330.0, 360.0, 390.0, 420.0, 450.0, 480.0, 510.0, 540.0, 570.0, 600.0, 630.0, 660.0, 690.0, 720.0, 750.0, 780.0, 810.0, 840.0, 870.0, 900.0]
#y_Tilt_30=[13.25640592387174, 13.070643464988212, 13.190618451152158, 13.209998335439359, 13.566344871972227, 14.03516827684577, 14.183377316455413, 13.954630940883888, 15.882101015271719, 17.262273495994275, 43.302829224695785, 275.64372126113926, 1639.8553938251737, 91.1733113797394, 23.683678368316855, 15.75919227884053, 14.997969857997312, 14.34580611363134, 13.739068042520898, 13.574098204444631, 13.115465744712925]
#v_Tilt_30=660.0
#
#x_Distance_301=[7389.700000000001, 7419.700000000001, 7449.700000000001, 7479.700000000001, 7509.700000000001, 7539.700000000001, 7569.700000000001, 7599.700000000001, 7629.700000000001, 7659.700000000001, 7689.700000000001]
#y_Distance_301=[40.085016891287665, 77.25750120426073, 241.0712056647266, 689.543712517267, 1388.692007834437, 1566.4821206414608, 832.1817665658097, 204.73741102021205, 59.86269006832782, 33.4151229563785, 17.780488412847863]
#v_Distance_301=7539.700000000001
#x_Tip_301=[560.0, 590.0, 620.0, 650.0, 680.0, 710.0, 740.0, 770.0, 800.0, 830.0, 860.0]
#y_Tip_301=[13.625562712006815, 13.932653302022679, 18.160315027260772, 29.192195588538404, 43.38230967688484, 148.09452660337766, 665.4752656090582, 1238.8075493338497, 865.0645914543152, 229.11401604823155, 66.85616400590405]
#v_Tip_301=770.0
#x_Tilt_301=[510.0, 540.0, 570.0, 600.0, 630.0, 660.0, 690.0, 720.0, 750.0, 780.0, 810.0]
#y_Tilt_301=[14.243515284466469, 18.332893526355107, 24.950219582666833, 80.97018907010957, 1474.3079669945537, 439.5932992181157, 38.062969839422536, 15.98914486187366, 15.60151214639864, 14.5309393781545, 14.114716553194604]
#v_Tilt_301=630.0

x_Distance_10=[7439.700000000001, 7449.700000000001, 7459.700000000001, 7469.700000000001, 7479.700000000001, 7489.700000000001, 7499.700000000001, 7509.700000000001, 7519.700000000001, 7529.700000000001, 7539.700000000001, 7549.700000000001, 7559.700000000001, 7569.700000000001, 7579.700000000001, 7589.700000000001, 7599.700000000001, 7609.700000000001, 7619.700000000001, 7629.700000000001, 7639.700000000001]
y_Distance_10=[1200.1950847778028, 842.8320868291867, 659.9420465996675, 435.41969266590615, 349.82872370696305, 215.8845196229811, 166.88779305012022, 107.99907196050856, 86.82628859808821, 67.65516287064386, 57.2917951933317, 55.02845460854478, 49.111992352946295, 47.77569959587773, 40.52625803682838, 35.48051336213555, 26.78171937711837, 21.71495966682624, 18.653293773277284, 17.66910839891308, 17.21739731274137]
v_Distance_10=7439.700000000001
x_Tip_10=[670.0, 680.0, 690.0, 700.0, 710.0, 720.0, 730.0, 740.0, 750.0, 760.0, 770.0, 780.0, 790.0, 800.0, 810.0, 820.0, 830.0, 840.0, 850.0, 860.0, 870.0]
y_Tip_10=[11.331348425438502, 11.687288575745992, 12.355885131353844, 12.803604254330093, 15.540756401692278, 18.562450807469027, 22.378879870746502, 26.498690069286564, 34.00338795070047, 48.34092890352035, 70.11018583673928, 139.87284744745276, 268.0108996810916, 443.70407346858315, 715.4732909188887, 943.2556908393296, 1060.1249690620841, 1061.962710843804, 964.779606531326, 743.198675398861, 434.41175111813067]
v_Tip_10=840.0
x_Tilt_10=[530.0, 540.0, 550.0, 560.0, 570.0, 580.0, 590.0, 600.0, 610.0, 620.0, 630.0, 640.0, 650.0, 660.0, 670.0, 680.0, 690.0, 700.0, 710.0, 720.0, 730.0]
y_Tilt_10=[14.77647547397331, 17.206195695008653, 28.50733954274716, 44.41196859321323, 50.13650363421627, 120.16816793316397, 335.84064256182194, 1081.4767200216734, 1568.6268773758588, 1302.2227227889193, 533.2245128006149, 144.78607856355052, 51.02665266630814, 31.30729397849781, 21.80294822742777, 15.698985032218364, 13.104429224410072, 12.04451439155173, 12.184370117910237, 11.849778787807436, 11.334264898879887]
v_Tilt_10=610.0

x_Distance_101=[7389.700000000001, 7399.700000000001, 7409.700000000001, 7419.700000000001, 7429.700000000001, 7439.700000000001, 7449.700000000001, 7459.700000000001, 7469.700000000001, 7479.700000000001, 7489.700000000001]
y_Distance_101=[983.9277299808043, 1138.957617827813, 1400.8387415290497, 1426.7097064750042, 1534.2319872353041, 1428.5667580641993, 1291.9681253169304, 1086.9076715219962, 869.4352808709983, 742.2411575142582, 480.1864967680722]
v_Distance_101=7429.700000000001
x_Tip_101=[790.0, 800.0, 810.0, 820.0, 830.0, 840.0, 850.0, 860.0, 870.0, 880.0, 890.0]
y_Tip_101=[111.22668961376957, 159.32748951301983, 310.9705336766192, 526.7132951773234, 758.7417581413863, 929.8192876450712, 994.8661694372995, 973.2697490429026, 806.8467140359608, 512.5880402829082, 307.3999219721572]
v_Tip_101=850.0
x_Tilt_101=[560.0, 570.0, 580.0, 590.0, 600.0, 610.0, 620.0, 630.0, 640.0, 650.0, 660.0]
y_Tilt_101=[88.51964033652384, 309.36879596657366, 1004.6249228042706, 1526.832341355992, 1324.681041009438, 661.1096439498817, 167.31844765922375, 53.654683130738036, 33.01503131927118, 24.48301435391919, 16.842900591858655]
v_Tilt_101=590.0

x_Distance_3=[7399.700000000001, 7402.700000000001, 7405.700000000001, 7408.700000000001, 7411.700000000001, 7414.700000000001, 7417.700000000001, 7420.700000000001, 7423.700000000001, 7426.700000000001, 7429.700000000001, 7432.700000000001, 7435.700000000001, 7438.700000000001, 7441.700000000001, 7444.700000000001, 7447.700000000001, 7450.700000000001, 7453.700000000001, 7456.700000000001, 7459.700000000001]
y_Distance_3=[1077.8800764241753, 1360.7758149414562, 1364.174861997184, 1405.5437743121897, 1439.2779180092323, 1427.7979301249238, 1421.2601880673828, 1484.3244745809088, 1517.9571115401807, 1454.2880746505089, 1444.5250161964718, 1416.4259476724078, 1403.9058244544476, 1371.0336920156115, 1322.5396699529765, 1338.4566042518845, 1253.4317337838393, 1154.0868551373806, 1093.4575993305275, 1036.7951730542263, 948.7841984885673]
v_Distance_3=7423.700000000001
x_Tip_3=[820.0, 823.0, 826.0, 829.0, 832.0, 835.0, 838.0, 841.0, 844.0, 847.0, 850.0, 853.0, 856.0, 859.0, 862.0, 865.0, 868.0, 871.0, 874.0, 877.0, 880.0]
y_Tip_3=[568.5469491913875, 645.6051013906845, 715.3359061114381, 759.1644647346773, 811.0913009511225, 883.5366390911045, 910.8816524907596, 950.8513991180961, 987.6954196135424, 1025.549641466855, 990.6736663871533, 986.3065062594467, 980.6637949198858, 963.6898869102895, 924.0412566418072, 927.3171510787156, 826.0054801011839, 747.2864776126514, 698.1705854921563, 617.2235370036562, 568.5723882838914]
v_Tip_3=850.0
x_Tilt_3=[560.0, 563.0, 566.0, 569.0, 572.0, 575.0, 578.0, 581.0, 584.0, 587.0, 590.0, 593.0, 596.0, 599.0, 602.0, 605.0, 608.0, 611.0, 614.0, 617.0, 620.0]
y_Tilt_3=[93.21771092628839, 156.90510908871101, 168.75819561559408, 328.81909502196845, 340.3904428352526, 645.2498380095528, 707.727923968666, 1140.4998616113612, 1273.781622173752, 1600.3996935630942, 1497.8037363107126, 1535.3659527647706, 1442.9200079258403, 1328.1635396576553, 1264.690182782595, 857.4010695320246, 875.548105556039, 253.99353767881254, 279.20481104941257, 293.4680689792118, 122.75612455191938]
v_Tilt_3=593.0

x_Distance_1=[7408.700000000001, 7409.700000000001, 7410.700000000001, 7411.700000000001, 7412.700000000001, 7413.700000000001, 7414.700000000001, 7415.700000000001, 7416.700000000001, 7417.700000000001, 7418.700000000001, 7419.700000000001, 7420.700000000001, 7421.700000000001, 7422.700000000001, 7423.700000000001, 7424.700000000001, 7425.700000000001, 7426.700000000001, 7427.700000000001, 7428.700000000001, 7429.700000000001, 7430.700000000001, 7431.700000000001, 7432.700000000001, 7433.700000000001, 7434.700000000001, 7435.700000000001, 7436.700000000001, 7437.700000000001, 7438.700000000001]
y_Distance_1=[1339.3833817793482, 1416.747487898544, 1421.495274226886, 1406.5244808280154, 1422.5686211529592, 1424.0667816676446, 1423.3723407299717, 1433.7441469585299, 1423.4946551494158, 1436.8102911211563, 1437.5535041326782, 1441.0183521898311, 1445.695552451666, 1461.4764369512943, 1439.5681616297966, 1450.6670337911992, 1442.2681823127723, 1440.5324383630655, 1438.0041100496096, 1440.7955979901585, 1426.5512961377635, 1463.0793442439756, 1438.0424829982185, 1408.2383139006615, 1431.2891210221062, 1387.163304243917, 1382.863091507953, 1377.8097903971839, 1392.4337786134088, 1351.1572504847568, 1312.5466026104543]
v_Distance_1=7423.700000000001
x_Tip_1=[835.0, 836.0, 837.0, 838.0, 839.0, 840.0, 841.0, 842.0, 843.0, 844.0, 845.0, 846.0, 847.0, 848.0, 849.0, 850.0, 851.0, 852.0, 853.0, 854.0, 855.0, 856.0, 857.0, 858.0, 859.0, 860.0, 861.0, 862.0, 863.0, 864.0, 865.0]
y_Tip_1=[833.3013941170375, 859.7516402209358, 874.421751355314, 901.5016261084804, 910.37354694948, 915.716203731108, 901.4025914500307, 942.7212793737201, 953.1415162761477, 1000.3250873941296, 1012.6698790999924, 1040.091253435856, 1038.6292844639427, 1018.6597329961992, 1020.2128382858264, 1006.6687082802341, 1009.4149073575779, 1002.2393406394399, 1012.8523433336029, 1013.712413857869, 1000.4646499624869, 993.2695375055619, 974.1267865957503, 978.2110549044435, 962.1059293514115, 964.7408283743312, 968.1827617177344, 978.6615247082138, 976.730522678536, 965.7236894280256, 960.2660145149235]
v_Tip_1=850.0
x_Tilt_1=[578.0, 579.0, 580.0, 581.0, 582.0, 583.0, 584.0, 585.0, 586.0, 587.0, 588.0, 589.0, 590.0, 591.0, 592.0, 593.0, 594.0, 595.0, 596.0, 597.0, 598.0, 599.0, 600.0, 601.0, 602.0, 603.0, 604.0, 605.0, 606.0, 607.0, 608.0]
y_Tilt_1=[637.1456517984428, 732.0429940444317, 807.4277332207726, 895.6741704556546, 976.4853140243868, 1093.8411214756034, 1180.9292913407817, 1200.2608802164045, 1243.6872375509806, 1346.4721774939703, 1385.3539435613263, 1450.2352911998692, 1467.5532476742546, 1488.8704879193947, 1548.4408267746198, 1552.6406587589822, 1544.4181816091407, 1525.3886063655186, 1533.1134987778603, 1523.903039817414, 1504.58557802641, 1476.2618570359605, 1442.636336328243, 1374.182153623061, 1325.4404847404649, 1239.4556385923493, 1186.287360347735, 1081.629605029974, 1024.888047501986, 951.7015119497081, 863.505723688759]
v_Tilt_1=595.0


#dist = 9930.0
#tip = 840.0
#tilt = 795.0
#post-dist = 10024.0



##########################################

#def get_fit(X,Y):
#
#    # do fit
#    tmp_A = []
#    tmp_b = []
#    for i in range(len(X)):
#        x_1 = X[i]/100.0
#        x_2 = x_1 * x_1
#        x_3 = x_1 * x_2
#        x_4 = x_2 * x_2
##        tmp_A.append([x_2, x_1, 1])
#        tmp_A.append([x_3, x_2, x_1, 1])
##        tmp_A.append([x_4, x_3, x_2, x_1, 1])
#        tmp_b.append(Y[i])
#    b = np.matrix(tmp_b).T
#    A = np.matrix(tmp_A)
#
#    fit = (A.T * A).I * A.T * b
#    errors = b - A * fit
#    residual = np.linalg.norm(errors)
#
#    print("solution:")
##    print("{} x^2 + {} x + {} = y".format(fit[0], fit[1], fit[2]))
#    print("{} x^3 + {} x^2 + {} x + {} = y".format(fit[0], fit[1], fit[2], fit[3]))
##    print("{} x^4 + {} x^3 + {} x^2 + {} x + {} = y".format(fit[0], fit[1], fit[2], fit[3], fit[4]))
#
#    y_new = np.zeros(len(X))
#    for i in range(len(X)):
#        x_1 = X[i]/100.0
#        x_2 = x_1 * x_1
#        x_3 = x_1 * x_2
#        x_4 = x_2 * x_2
##        y_new[i] = fit[0] * x_2 + fit[1] * x_1 + fit[2]
#        y_new[i] = fit[0] * x_3 + fit[1] * x_2 + fit[2] * x_1 + fit[3]
##        y_new[i] = fit[0] * x_4 + fit[1] * x_3 + fit[2] * x_2 + fit[3] * x_1 + fit[4]
#    return y_new

def get_fit(X,Y):
    z = np.polyfit(X, Y, 3)

    print("solution:")
    print("{} x^3 + {} x^2 + {} x + {} = y".format(z[0], z[1], z[2], z[3]))

    p = np.poly1d(z)

    y_new = np.zeros(len(X))
    for i in range(len(X)):
        x_1 = X[i]
        y_new[i] = p(x_1)
    return y_new



#xs = [[x_Distance_80, x_Distance_30, x_Distance_10, x_Distance_3, x_Distance_1],
#    [x_Tip_80, x_Tip_30, x_Tip_10, x_Tip_3, x_Tip_1],
#    [x_Tilt_80, x_Tilt_30, x_Tilt_10, x_Tilt_3, x_Tilt_1]]
#ys =  [[y_Distance_80, y_Distance_30, y_Distance_10, y_Distance_3, y_Distance_1],
#   [y_Tip_80, y_Tip_30, y_Tip_10, y_Tip_3, y_Tip_1],
#   [y_Tilt_80, y_Tilt_30, y_Tilt_10, y_Tilt_3, y_Tilt_1]]
#fs =  [[v_Distance_80, v_Distance_30, v_Distance_10, v_Distance_3, v_Distance_1],
#   [v_Tip_80, v_Tip_30, v_Tip_10, v_Tip_3, v_Tip_1],
#   [v_Tilt_80, v_Tilt_30, v_Tilt_10, v_Tilt_3, v_Tilt_1]]

xs = [[x_Distance_80, x_Distance_801, x_Distance_30, x_Distance_301, x_Distance_10, x_Distance_101, x_Distance_3, x_Distance_1],
    [x_Tip_80, x_Tip_801, x_Tip_30, x_Tip_301, x_Tip_10, x_Tip_101, x_Tip_3, x_Tip_1],
    [x_Tilt_80, x_Tilt_801, x_Tilt_30, x_Tilt_301, x_Tilt_10, x_Tilt_101, x_Tilt_3, x_Tilt_1]]
ys =  [[y_Distance_80, y_Distance_801, y_Distance_30, y_Distance_301, y_Distance_10, y_Distance_101, y_Distance_3, y_Distance_1],
   [y_Tip_80, y_Tip_801, y_Tip_30, y_Tip_301, y_Tip_10, y_Tip_101, y_Tip_3, y_Tip_1],
   [y_Tilt_80, y_Tilt_801, y_Tilt_30, y_Tilt_301, y_Tilt_10, y_Tilt_101, y_Tilt_3, y_Tilt_1]]
fs =  [[v_Distance_80, v_Distance_801, v_Distance_30, v_Distance_301, v_Distance_10, v_Distance_101, v_Distance_3, v_Distance_1],
   [v_Tip_80, v_Tip_801, v_Tip_30, v_Tip_301, v_Tip_10, v_Tip_101, v_Tip_3, v_Tip_1],
   [v_Tilt_80, v_Tilt_801, v_Tilt_30, v_Tilt_301, v_Tilt_10, v_Tilt_101, v_Tilt_3, v_Tilt_1]]


max_y_val = 0
for i in range (3):
    for j in range (8):
        if max(ys[i][j]) > max_y_val:
            max_y_val = max(ys[i][j])

fig, axs = plt.subplots(3, 8)
for i in range (3):
    for j in range (8):
        # Set labels
        # axs[0, j].set(xlabel='Axis position (um)')
        # axs[1, j].set(xlabel='Axis position (um)')
        # axs[2, j].set(xlabel='Axis position (um)')

        # plot data
        axs[i, j].plot(xs[i][j], ys[i][j])
        # axs[i, j].plot(xs[i][j], np.divide(ys[i][j],1000))
        if j >= 6:
            axs[i, j].plot(xs[i][j], get_fit(xs[i][j],ys[i][j]))
            # axs[i, j].plot(xs[i][j], np.divide(get_fit(xs[i][j],ys[i][j]),1000))
        axs[i, j].axvline(fs[i][j], color='r')
        axs[i, j].set_ylim([0,max_y_val])
        if j is not 0:
            axs[i, j].set_yticklabels([])
            axs[i, j].tick_params(axis="y",direction="in", pad=-22)

axs[0, 0].set_title('80 um')
axs[0, 1].set_title('80 um')
axs[0, 2].set_title('30 um')
axs[0, 3].set_title('30 um')
axs[0, 4].set_title('10 um')
axs[0, 5].set_title('10 um')
axs[0, 6].set_title('3 um')
axs[0, 7].set_title('1 um')

# axs[0, 0].set(ylabel='Focus Score - Distance')
# axs[1, 0].set(ylabel='Focus Score - Tip')
# axs[2, 0].set(ylabel='Focus Score - Tilt')

axs[0, 0].set(ylabel='Distance Axis')
axs[1, 0].set(ylabel='Tip Axis')
axs[2, 0].set(ylabel='Tilt Axis')

# fig.tight_layout()

fig.supxlabel('Axis position (um)', y = 0.05)
fig.supylabel('Focus Score', x = 0.05)
# fig.suptitle('Axis Focus Iterations', y = 0.95, weight = "heavy")

plt.show()





# s = plt.subplots(3, 8)
# for i in range (3):
#     for j in range (8):
#         axs[i, j].plot(xs[i][j], np.divide(ys[i][j],1000))
#         if j >= 6:
#             axs[i, j].plot(xs[i][j], np.divide(get_fit(xs[i][j],ys[i][j]),1000))
#         axs[i, j].axvline(fs[i][j], color='r')

# axs[0, 0].set_title('80 um')
# axs[0, 1].set_title('80 um')
# axs[0, 2].set_title('30 um')
# axs[0, 3].set_title('30 um')
# axs[0, 4].set_title('10 um')
# axs[0, 5].set_title('10 um')
# axs[0, 6].set_title('3 um')
# axs[0, 7].set_title('1 um')

# axs[0, 0].set(xlabel='Axis position (um)')
# axs[0, 1].set(xlabel='Axis position (um)')
# axs[0, 2].set(xlabel='Axis position (um)')
# axs[0, 3].set(xlabel='Axis position (um)')
# axs[0, 4].set(xlabel='Axis position (um)')
# axs[0, 5].set(xlabel='Axis position (um)')
# axs[0, 6].set(xlabel='Axis position (um)')
# axs[0, 7].set(xlabel='Axis position (um)')

# axs[1, 0].set(xlabel='Axis position (um)')
# axs[1, 1].set(xlabel='Axis position (um)')
# axs[1, 2].set(xlabel='Axis position (um)')
# axs[1, 3].set(xlabel='Axis position (um)')
# axs[1, 4].set(xlabel='Axis position (um)')
# axs[1, 5].set(xlabel='Axis position (um)')
# axs[1, 6].set(xlabel='Axis position (um)')
# axs[1, 7].set(xlabel='Axis position (um)')

# axs[2, 0].set(xlabel='Axis position (um)')
# axs[2, 1].set(xlabel='Axis position (um)')
# axs[2, 2].set(xlabel='Axis position (um)')
# axs[2, 3].set(xlabel='Axis position (um)')
# axs[2, 4].set(xlabel='Axis position (um)')
# axs[2, 5].set(xlabel='Axis position (um)')
# axs[2, 6].set(xlabel='Axis position (um)')
# axs[2, 7].set(xlabel='Axis position (um)')

# axs[0, 0].set(ylabel='Focus Score - Distance')
# axs[1, 0].set(ylabel='Focus Score - Tip')
# axs[2, 0].set(ylabel='Focus Score - Tilt')

# fig.tight_layout()

# plt.show()
